<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Filmes em Cartaz</title>
  <style>
    /* Estilo geral da p√°gina */
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(-45deg, #1e3c72, #2a5298, #ee7752, #e73c7e);
      background-size: 400% 400%;
      animation: gradientBackground 15s ease infinite; /* Anima√ß√£o do fundo */
      color: #f7f6f6;
      overflow-x: hidden;
      position: relative;
    }

    /* Anima√ß√£o do fundo colorido */
    @keyframes gradientBackground {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Estiliza√ß√£o do cabe√ßalho */
    header {
      background-color: rgba(0, 0, 0, 0.6);
      padding: 1rem;
      text-align: center;
      position: relative;
      z-index: 2;
    }

    /* Campo de busca */
    #searchInput {
      padding: 0.5rem;
      width: 60%;
      margin-top: 1rem;
      border-radius: 8px;
      border: none;
    }

    /* Filtros (avalia√ß√£o, ano, popularidade) */
    #filters select {
      padding: 0.5rem;
      margin: 0.5rem;
      border-radius: 6px;
      border: none;
    }

    /* √Årea principal onde os filmes s√£o exibidos */
    main {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 1rem;
      position: relative;
      z-index: 2;
    }

    /* Estilo de cada card de filme */
    .movie-card {
      background-color: rgba(0, 0, 0, 0.6);
      margin: 1rem;
      padding: 1rem;
      border-radius: 12px;
      width: 200px;
      text-align: center;
      z-index: 2;
    }

    /* Imagem do filme */
    .movie-card img {
      width: 100%;
      border-radius: 8px;
    }

    /* Bot√£o para ver detalhes */
    .movie-card button {
      margin-top: 10px;
      background-color: #0af;
      color: white;
      border: none;
      padding: 8px;
      border-radius: 6px;
      cursor: pointer;
    }

    /* Estilo da √°rea de detalhes do filme */
    .movie-details {
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      padding: 10px;
      margin-top: 10px;
      font-size: 14px;
      text-align: left;
    }

    /* V√≠deo do trailer */
    iframe {
      width: 100%;
      border-radius: 10px;
      margin-top: 10px;
    }

    /* Estilo dos personagens decorativos animados */
    .character {
      position: absolute;
      width: 80px;
      opacity: 0.3;
      z-index: 1;
    }

    /* Anima√ß√£o esquerda ‚Üí direita */
    @keyframes moveLeftRight {
      0% { left: -100px; }
      100% { left: 110%; }
    }

    /* Anima√ß√£o direita ‚Üí esquerda */
    @keyframes moveRightLeft {
      0% { left: 110%; }
      100% { left: -100px; }
    }
  </style>
</head>
<body>
  <!-- Cabe√ßalho com t√≠tulo e filtros -->
  <header>
    <h1>üé¨ Filmes em Cartaz</h1>
    <input type="text" id="searchInput" placeholder="Buscar filme...">

    <div id="filters">
      <!-- Filtro por avalia√ß√£o -->
      <select id="ratingFilter">
        <option value="">Filtrar por avalia√ß√£o</option>
        <option value="high">Mais avaliados</option>
        <option value="medium">Mediamente avaliados</option>
        <option value="low">Menos avaliados</option>
      </select>

      <!-- Filtro por ano -->
      <select id="yearFilter">
        <option value="">Filtrar por ano</option>
        <option value="2025">Lan√ßados em 2025</option>
        <option value="2024">Lan√ßados em 2024</option>
      </select>

      <!-- Filtro por popularidade -->
      <select id="popularityFilter">
        <option value="">Filtrar por popularidade</option>
        <option value="high">Mais populares</option>
        <option value="low">Menos populares</option>
      </select>
    </div>
  </header>

  <!-- Container onde os filmes ser√£o exibidos -->
  <main id="moviesContainer"></main>

  <script>
    // Chave de API e URL base da The Movie Database
    const API_KEY = 'd29e79bb675e164fc1f28decd659e21c'; 
    const BASE_URL = 'https://api.themoviedb.org/3';

    // Seletores do HTML
    const moviesContainer = document.getElementById('moviesContainer');
    const searchInput = document.getElementById('searchInput');

    // Fun√ß√£o para buscar os filmes da API
    async function fetchMovies(url) {
      const response = await fetch(url);
      const data = await response.json();
      displayMovies(data.results); // Exibe os filmes na tela
    }

    // Fun√ß√£o que monta os cards com os dados dos filmes
    function displayMovies(movies) {
      moviesContainer.innerHTML = ''; // Limpa os filmes anteriores
      movies.forEach(movie => {
        const movieEl = document.createElement('div');
        movieEl.classList.add('movie-card');
        movieEl.innerHTML = `
          <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" alt="${movie.title}" />
          <h3>${movie.title}</h3>
          <p>Nota: ${movie.vote_average}</p>
          <button onclick="toggleDetalhes(${movie.id}, this)">Ver detalhes</button>
          <div id="detalhes-${movie.id}" class="movie-details" style="display: none;"></div>
        `;
        moviesContainer.appendChild(movieEl); // Adiciona o card ao container
      });
    }

    // Fun√ß√£o que alterna a exibi√ß√£o dos detalhes do filme
    async function toggleDetalhes(id, btn) {
      const detalheDiv = document.getElementById(`detalhes-${id}`);

      if (detalheDiv.style.display === 'none') {
        // Busca detalhes, elenco e v√≠deos ao mesmo tempo
        const [detalhes, creditos, videos] = await Promise.all([
          fetch(`${BASE_URL}/movie/${id}?api_key=${API_KEY}&language=pt-BR`).then(res => res.json()),
          fetch(`${BASE_URL}/movie/${id}/credits?api_key=${API_KEY}&language=pt-BR`).then(res => res.json()),
          fetch(`${BASE_URL}/movie/${id}/videos?api_key=${API_KEY}&language=pt-BR`).then(res => res.json())
        ]);

        // Monta elenco (m√°x. 5 atores)
        const elenco = creditos.cast.slice(0, 5).map(ator => ator.name).join(', ') || 'Informa√ß√£o indispon√≠vel';

        // Busca o trailer
        const trailer = videos.results.find(v => v.type === "Trailer" && v.site === "YouTube");
        const embedTrailer = trailer
          ? `<iframe height="250" src="https://www.youtube.com/embed/${trailer.key}" frameborder="0" allowfullscreen></iframe>`
          : 'Trailer n√£o dispon√≠vel.';

        // Exibe os detalhes formatados
        detalheDiv.innerHTML = `
          <p><strong>Sinopse:</strong> ${detalhes.overview || 'Sinopse n√£o dispon√≠vel.'}</p>
          <p><strong>Elenco:</strong> ${elenco}</p>
          <p><strong>Trailer:</strong><br>${embedTrailer}</p>
        `;
        detalheDiv.style.display = 'block';
        btn.innerText = 'Ocultar detalhes';
      } else {
        detalheDiv.style.display = 'none';
        btn.innerText = 'Ver detalhes';
      }
    }

    // Fun√ß√£o que aplica os filtros selecionados
    function applyFilters() {
      let url = `${BASE_URL}/discover/movie?api_key=${API_KEY}&language=pt-BR&sort_by=popularity.desc`;

      const rating = document.getElementById('ratingFilter').value;
      const year = document.getElementById('yearFilter').value;
      const popularity = document.getElementById('popularityFilter').value;

      // Aplica filtros de avalia√ß√£o
      if (rating === 'high') url += '&vote_average.gte=7.5';
      if (rating === 'medium') url += '&vote_average.gte=5&vote_average.lte=7.4';
      if (rating === 'low') url += '&vote_average.lte=5';

      // Aplica filtro de ano
      if (year) url += `&primary_release_year=${year}`;

      // Aplica filtro de popularidade
      if (popularity === 'high') url += '&sort_by=popularity.desc';
      if (popularity === 'low') url += '&sort_by=popularity.asc';

      fetchMovies(url);
    }

    // Eventos que disparam a fun√ß√£o de filtro ao mudar uma op√ß√£o
    document.getElementById('ratingFilter').addEventListener('change', applyFilters);
    document.getElementById('yearFilter').addEventListener('change', applyFilters);
    document.getElementById('popularityFilter').addEventListener('change', applyFilters);

    // Busca por texto (nome do filme) em tempo real
    searchInput.addEventListener('input', () => {
      const query = searchInput.value.toLowerCase();
      fetch(`${BASE_URL}/search/movie?api_key=${API_KEY}&query=${query}&language=pt-BR`)
        .then(res => res.json())
        .then(data => displayMovies(data.results));
    });

    // Ao carregar a p√°gina, exibe os filmes em cartaz
    fetchMovies(`${BASE_URL}/movie/now_playing?api_key=${API_KEY}&language=pt-BR&page=1`);
  </script>

  <!-- Personagens animados decorando o fundo da p√°gina -->
  <img src="https://cdn.pixabay.com/photo/2020/05/01/07/58/movie-5114746_960_720.png"
       class="character" style="top: 120px; animation: moveLeftRight 20s infinite linear;">
  <img src="https://cdn.pixabay.com/photo/2021/09/20/15/46/ghost-6641512_960_720.png"
       class="character" style="top: 300px; animation: moveRightLeft 25s infinite linear;">
</body>
</html>
